
<h2>任务列表</h2>

<!--
    <div>
      <select id="year" class="">
        {{#each years}}
        <option>{{this}}</option>
        {{/each}}
      </select>
      <select id="month" class="">
        {{#each months}}
        <option>{{this}}</option>
        {{/each}}
      </select>
      <a href=""></a>
    </div>
    -->
<div class="row">
  <div class="col-sm-6">
    <button type="button" class="btn btn-primary" data-toggle="button">增加</button>
  </div>
  <div class='col-sm-6'>
    <div class="form-group">
      <div class='input-group date' id='datetimepicker2'>
        <input type='text' class="form-control" />
        <span class="input-group-addon">
          <span class="glyphicon glyphicon-calendar"></span>
        </span>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    $(function () {
    $('#datetimepicker2').datetimepicker({
    locale: 'zh-cn',
    format: 'YYYY-MM-DD',
    calendarWeeks: true
    });
    });
  </script>
</div>

<div class="table-responsive">
  <table class="table table-striped table-bordered table-hover">
    <tr>
      <th>工作类型</th>
      <th>工作任务</th>
      <th>工作内容</th>
      <th>达成情况</th>
      <th>用时</th>
      <th>操作</th>
    </tr>
    {{#each reviews}}
    <tr>
      <td>{{catalog}}</td>
      <td>{{task}}</td>
      <td>{{content}}</td>
      <td>{{progress}}</td>
      <td>{{cost}}</td>
      <td><a href="javascript:;" class="btn edit btn-info">修改</a></td>
    </tr>
    {{/each}}
  </table>
</div>

<script type="text/javascript">
  //增加
  $(".btn-primary").click(function(){
    if($("table tr").hasClass("addtr") || $("table tr").hasClass("edittr")){
      alert("先完成操作！！！");
  }else{
  $("table tr:last").after('<tr class="addtr">'
    + '<td><input type="text" name="names" value="" /></td>'
    + '<td><input type="text" name="sexs" value="" /></td>'
    + '<td><input type="text" name="ages" value="" /></td>'
    + '<td><a href="javascript:;" class="btn save btn-info">保存</a> '
      + '<a href="javascript:;" class="btn off btn-info">取消</a> </td>'
    + '</tr>');
  }
  })

  //保存
  $(document).on("click",".save",function(){

  var name =$(this).parent().parent().find('input[name="names"]').val();
  var sex =$('input[name="sexs"]').val();
  var age =$('input[name="ages"]').val();

  var n="";
  n+='<td>'+name+'</td>';
  n+='<td>'+sex+'</td>';
  n+='<td>'+age+'</td>';
  n+='<td>';
    n+='<a href="javascript:;" class="btn edit btn-info"><span class="icon-edit"></span>修改</a>';
    n+='</td>';
  $(this).parent().parent().removeClass("addtr edittr");
  $(this).parent().parent().html(n);
  })

  var old_name = "";
  var old_sex = "";
  var old_age = "";

  //修改
  $(document).on("click",".edit",function() {
  if($("table tr").hasClass("addtr") || $("table tr").hasClass("edittr")) {
  alert("先完成操作！！！");
  }else{
  var name =$(this).parent().parent().find('td').eq(0).text();
  var sex =$(this).parent().parent().find('td').eq(1).text();
  var age =$(this).parent().parent().find('td').eq(2).text();

  old_name = name;
  old_sex = sex;
  old_age = age;

  var n="";
  n+='<td><input type="text" name="names" value="'+name+'" /></td>';
  n+=' <td><input type="text" name="sexs" value="'+sex+'" /></td>';
  n+='  <td><input type="text" name="ages" value="'+age+'" /></td>';
  n+=' <td>';
    n+='  <a href="javascript:;" class="btn save btn-info">保存</a>';
    n+='  <a href="javascript:;" class="btn off btn-info">取消</a>';
    n+=' </td>';
  $(this).parent().parent().addClass("edittr");
  $(this).parent().parent().html(n);
  }

  })

  $(document).on("click",".off",function(){
  if ($("table tr").hasClass("edittr")) {
  var n="";
  n+='<td>'+old_name+'</td>';
  n+='<td>'+old_sex+'</td>';
  n+='<td>'+old_age+'</td>';
  n+='<td>';
    n+='<a href="javascript:;" class="btn edit btn-info"><span class="icon-edit"></span>修改</a>';
    n+='</td>';
  $(this).parent().parent().removeClass("edittr");
  $(this).parent().parent().html(n);
  }
  else {
    $(this).parent().parent().remove();
  }

  //  window.location.reload();
  })
</script>
